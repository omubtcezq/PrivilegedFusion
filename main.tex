
%% bare_conf.tex
%% V1.4b
%% 2015/08/26
%% by Michael Shell
%% See:
%% http://www.michaelshell.org/
%% for current contact information.
%%
%% This is a skeleton file demonstrating the use of IEEEtran.cls
%% (requires IEEEtran.cls version 1.8b or later) with an IEEE
%% conference paper.
%%
%% Support sites:
%% http://www.michaelshell.org/tex/ieeetran/
%% http://www.ctan.org/pkg/ieeetran
%% and
%% http://www.ieee.org/

\documentclass[conference]{IEEEtran}

% Imports
\usepackage{local_macros/isasmathmacros}

% Environments
\newtheorem{definition}{Definition}[section]
\newtheorem{theorem}{Theorem}[section]

% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}


\begin{document}

% paper title
\title{Privileged Estimate Fusion With Correlated Gaussian Keystreams}

\author{\IEEEauthorblockN{Marko Ristic}
\IEEEauthorblockA{Autonomous Multisensor Systems Group (AMS),\\
Institute for Intelligent Cooperating Systems (ICS),\\
Otto von Guericke University (OVGU),\\
Magdeburg, Germany\\
Email: marko.ristic@ovgu.de}
\and
\IEEEauthorblockN{Benjamin Noack}
\IEEEauthorblockA{Autonomous Multisensor Systems Group (AMS),\\
Institute for Intelligent Cooperating Systems (ICS),\\
Otto von Guericke University (OVGU),\\
Magdeburg, Germany\\
Email: benjamin.noack@ovgu.de}}

% make the title area
\maketitle

% 
%        d8888 888888b.    .d8888b.  
%       d88888 888  "88b  d88P  Y88b 
%      d88P888 888  .88P  Y88b.      
%     d88P 888 8888888K.   "Y888b.   
%    d88P  888 888  "Y88b     "Y88b. 
%   d88P   888 888    888       "888 
%  d8888888888 888   d88P Y88b  d88P 
% d88P     888 8888888P"   "Y8888P"  
%                                    
%                                    
%                                    
% 

% As a general rule, do not put math, special symbols or citations in the abstract
\begin{abstract}
Providing cryptographic privacy guarantees in a distributed state estimation problem has been a growing topic of research since the ubiquity of modern public networks. One such guarantee is having different levels of estimation performance achievable by trusted and untrusted users within a sensor network. In the presence of multiple sensor measurements, guaranteeing better estimation performance by the usual means of adding removable noise to measurements is complicated by an alternative for untrusted users to improve their performance: fusing more measurements. Our novel method adds correlated noise at different sensors, restricting the performance gained from fusing additional measurements while guaranteeing better performance to those that can remove it. We extend a cryptographic framework for defining estimation privilege and use this to prove the scheme's security goals, while simulations demonstrate the effects of parameters in a concrete estimation problem. A scheme that can ensure such differences in estimation performance between types of estimators can find applications in priority-based or subscription-based performances in environments where more than one sensor is present.
\end{abstract}

% no keywords

\IEEEpeerreviewmaketitle

% 
% 8888888 888b    888 88888888888 8888888b.   .d88888b.  
%   888   8888b   888     888     888   Y88b d88P" "Y88b 
%   888   88888b  888     888     888    888 888     888 
%   888   888Y88b 888     888     888   d88P 888     888 
%   888   888 Y88b888     888     8888888P"  888     888 
%   888   888  Y88888     888     888 T88b   888     888 
%   888   888   Y8888     888     888  T88b  Y88b. .d88P 
% 8888888 888    Y888     888     888   T88b  "Y88888P"  
%                                                        
%                                                        
%                                                        
% 

\section{Introduction}\label{sec:intro}
Sensor data processing and state estimation have long been active areas of research and continue to find applications in modern systems \cite{andersonOptimalFiltering1979,simonOptimalStateEstimation2006}. In the context of distributed sensing environments such as decentralised autonomous vehicles or distributed weather stations, estimation methods relying on Kalman filters and derivatives \cite{haugBayesianEstimationTracking2012} are particular prevalent due to their recursive, often optimal, estimation properties and their suitability to modelling measurement cross-correlations typically required for data fusion \cite{mutambaraDecentralizedEstimationControl1998,ligginsDistributedDataFusion2012}. In recent years, the ubiquity of distributed public networks has seen the additional requirements of preserving algorithm participants' privacies, such as individual contributions or identifying information, become increasingly relevant and has led to an active field of research \cite{renSecurityChallengesPublic2012,brennerSecretProgramExecution2011}.

While hiding transmitted information to eavesdroppers can be achieved using common encryption schemes that make ciphertexts indistinguishable \cite{katzIntroductionModernCryptography2008}, distributed estimation tasks that preserve participants' privacies require information to remain hidden during partial or complete processing of the task and often justify some leakage \cite{risticSecureFastCovariance2021,shiPrivacyPreservingAggregationTimeSeries2011}. The security goals of these problems are context-specific and have produced a variety of solutions. In \cite{alanwarPrOLocResilientLocalization2017}, non-Bayesian localisation is performed using homomorphic encryption such that individual sensor information and measurements remain private, while in \cite{aristovEncryptedMultisensorInformation2018}, similar goals are achieved in a Bayesian setting by fusing linear measurements when sensors form a hierarchical network. A combination of homomorphic and order-revealing encryption schemes are used in \cite{risticSecureFastCovariance2021} to solve conservative Gaussian estimate fusion while leaking only the ratios of estimate covariances, and in \cite{shiPrivacyPreservingAggregationTimeSeries2011,joyeScalableSchemePrivacyPreserving2013}, cryptographic aggregation schemes are introduced and used to leak only total consumptions in an energy grid while hiding individual participant power-usages. In addition to these examples of privacy, achieved through hiding and leaking quantifiable information, optimal estimation performance itself can be considered leakage, which introduces a privilege in estimation where leakage defines the difference in performance between trusted and untrusted estimators. In the original Global Positioning System (GPS) \cite{grovesPrinciplesGNSSInertial2015}, this was achieved with a secondary encrypted channel that allowed better estimation performance to parties that held an encryption key. Similarly, in \cite{murguiaInformationTheoreticPrivacyChaos2020}, a synchronised chaotic system is used to add noise to measurements which can only be removed by estimators knowing its properties. This idea of estimation privilege is further explored in \cite{risticCryptographicallyPrivilegedState2022}, where a formal cryptographic definition is given and a scheme for a single sensor presented. Here, a synchronised pseudorandom Gaussian keystream adds measurement noise only removable by estimators holding the stream key.

In this work, we consider this definition of estimation privilege, presented in \cite{risticCryptographicallyPrivilegedState2022}, and introduce a modified scheme suitable for an environment of multiple sensors, where both holding the secret key and fusing additional measurements can lead to better estimation performance. Our contribution consists of a generalised notion of estimation privilege, the introduction of security requirements for privileged estimation in a well defined multisensor environment and a scheme that satisfies them. Along with a cryptographic proof sketch, simulation results are provided to demonstrate the effects of scheme parameters and how they can be chosen to provide varying amounts of privilege. Use-cases for varying performance in this way include subscription or priority models where some users are provided better results than others. For example, subscription-based weather forecasts using measurements from spatially distributed stations or modular mass-produced sensors that differ in accuracy dependent on cost.

In section \ref{sec:prob}, the multisensor estimation privilege problem is presented. Relevant preliminaries are introduced in section \ref{sec:prelim} and the estimation privilege fusion scheme itself in section \ref{sec:scheme}. A cryptographic analysis and the simulation results are then given in sections \ref{sec:crypto} and \ref{sec:sim}, respectively, before the concluding remarks in section \ref{sec:conc}.

\subsection{Notation}\label{subsec:notation}
\begin{itemize}
  \item Matrices, vectors.
  \item Positive definitness.
  \item Diag function for normal and block vectors
  \item Pseudorandom distribution.
  \item Estimator in cryptographic sense.
  \item Negligible fuction and negligible covariance.
\end{itemize}

% 
% 8888888b.  8888888b.   .d88888b.  888888b.   
% 888   Y88b 888   Y88b d88P" "Y88b 888  "88b  
% 888    888 888    888 888     888 888  .88P  
% 888   d88P 888   d88P 888     888 8888888K.  
% 8888888P"  8888888P"  888     888 888  "Y88b 
% 888        888 T88b   888     888 888    888 
% 888        888  T88b  Y88b. .d88P 888   d88P 
% 888        888   T88b  "Y88888P"  8888888P"  
%                                              
%                                              
%                                              
% 

\section{Problem Formulation}\label{sec:prob}
We are interested in environments where multiple sensors are present and the fusion of their measurements can lead to better state estimation accuracy of the system they are measuring. In these environments, we want to provide levels of privilege to state estimators such those with a higher privilege can perform better than those with a lower one, while taking into consideration the estimation benefits from fusing additional measurements. We will consider linear and Gaussian models, where a state $\vec{x}_k \in \mathbb{R}^n$ at an integer timestep $k$, follows a system model given by
\begin{equation}
  \vec{x}_k = \mat{F}_k \vec{x}_{k-1} + \vec{w}_k\,,
\end{equation}
with white noise term $\vec{w}_k \sim \mathcal{N}(\vec{0},\mat{Q}_k)$ and a known covariance $\mat{Q}_k \in \mathbb{R}^{n \times n}$. Similarly, measurements $\vec{y}_{k,i} \in \mathbb{R}^m$ from each sensor $i$, $1\leq i\leq N$, follow the measurement models
\begin{equation}
  \vec{y}_{k,i} = \mat{H}_{k,i} \vec{x}_k + \vec{v}_{k,i}\,,
\end{equation}
with white noise term $\vec{v}_{k,i} \sim \mathcal{N}(\vec{0},\mat{R}_{k,i})$ and a known covariance $\mat{R}_{k,i} \in \mathbb{R}^{m \times m}$. In addition to these models, we assume that all sensors $i$ are synchronised in timesteps $k$ to simplify later cryptographic evaluation. In practice, this would restrict the presented schemes to scenarios where synchronisation is easier to guarantee, such as ones where measurements are taken infrequently.

Each of the sensors also holds a secret key $\mathsf{sk}_i$, which can be made available to estimators of appropriate privilege. The privileges that we consider, in terms of access to keys and measurements, will be defined by sequential sensors. That is, in the presence of $N$ sensors, we consider exactly $N$ possible privilege levels, where each privilege $p>0$ corresponds to holding the sequential secret keys $\mathsf{sk}_j$, $1\leq j \leq p$ while being unprivileged, $p=0$, corresponds to holding none. We assume that estimators have access to all ``privileged measurements'', those from sensors whose keys they hold, and can additionally fuse ``unprivileged measurements'' from those whose keys they do not hold. We can therefore capture their capabilities by letting $\mathsf{e}_{p,q}$ denote an estimator with privilege $p$ and access to measurements from $q\geq p$ sensors, $1\leq i \leq q$.

To cryptographically guarantee the difference between estimation performances, we will use the notion of covariance privilege introduced in \cite{risticCryptographicallyPrivilegedState2022} and given in section \ref{sec:prelim}. As we want better performance for higher privilege estimators as well as to limit the gained performance from fusing unprivileged measurements, two differences will be considered.
\begin{LaTeXdescription}
  \item[Different Keys] First, we want to guarantee a lower bound on the difference between the best unprivileged estimator $\mathsf{e}_{0,N}$ and the best privilege-$p$ estimator $\mathsf{e}_{p,p}$. This will, therefore, remain a lower-bound when unprivileged estimators have access to fewer unprivileged measurements or privileged estimators have access to more.
  \item[Same Keys] Second, we want to guarantee an upper bound on the difference between the best privilege-$p$ estimators $\mathsf{e}_{p,p}$ and $\mathsf{e}_{p,N}$. Here, the bound remains an upper bound on the gained estimation performance of any privilege-$p$ estimator fusing additional unprivileged measurements.
\end{LaTeXdescription}
The resulting scheme should be such that two parameters are responsible for choosing the values of these two bounds.

% 
% 8888888b.  8888888b.  8888888888 888      8888888 888b     d888 
% 888   Y88b 888   Y88b 888        888        888   8888b   d8888 
% 888    888 888    888 888        888        888   88888b.d88888 
% 888   d88P 888   d88P 8888888    888        888   888Y88888P888 
% 8888888P"  8888888P"  888        888        888   888 Y888P 888 
% 888        888 T88b   888        888        888   888  Y8P  888 
% 888        888  T88b  888        888        888   888   "   888 
% 888        888   T88b 8888888888 88888888 8888888 888       888 
%                                                                 
%                                                                 
%                                                                 
% 

\section{Preliminaries}\label{sec:prelim}
When defining our scheme and discussing its cryptographic guarantees, we will make use of Gaussian keystreams and the notion of cryptographic estimation covariance privilege. These have been summarised below.

% 
% ##    ## ######## ##    ##  ######  ######## ########  ########    ###    ##     ## 
% ##   ##  ##        ##  ##  ##    ##    ##    ##     ## ##         ## ##   ###   ### 
% ##  ##   ##         ####   ##          ##    ##     ## ##        ##   ##  #### #### 
% #####    ######      ##     ######     ##    ########  ######   ##     ## ## ### ## 
% ##  ##   ##          ##          ##    ##    ##   ##   ##       ######### ##     ## 
% ##   ##  ##          ##    ##    ##    ##    ##    ##  ##       ##     ## ##     ## 
% ##    ## ########    ##     ######     ##    ##     ## ######## ##     ## ##     ## 
% 

\subsection{Gaussian keystreams}\label{subsec:gauss_keystreams}
A Gaussian keystream is a sequence of pseudorandom multivariate Gaussian samples $\vec{g}_k\ \dot{\sim}\ \mathcal{N}(\vec{0},\mat{S})$, $k>0$, for some covariance matrix $\mat{S}$, generated using a secret key. The sequence is indistinguishable from a truly random multivariate Gaussian sequence to any observer who does not hold the key while being reproducible exactly by those that do. The keystream can be constructed from a typical cryptographic stream cipher \cite[Ch. 3.6]{katzIntroductionModernCryptography2008}, by using any common method for random floating-point generation \cite{goualardGeneratingRandomFloatingPoint2020} to create a stream of pseudorandom uniform samples $u_i\ \dot{\sim}\ \mathcal{U}(0,1)$, $i>0$. Here, we make the assumption that floating-point representations of real numbers are sufficiently similar to actual real numbers, made reasonable in practice due to the insignificance of their difference in many applications and their prevalence in estimation theory.

To construct the Gaussian keystream $\vec{g}_k$, $k>0$, from the uniform one $u_i$, $i>0$, a vector of uncorrelated standard Gaussian samples $\vec{z}_k$ is first generated using the Box-Muller transform,
\begin{equation}\label{eqn:standard_gaussian_generation}
    \vec{z}_k = 
  \begin{bmatrix}
    z_{(k-1)n+1} & \cdots & z_{kn}
  \end{bmatrix}^\top
\end{equation}
where 
\begin{equation*}
  z_i =
  \begin{cases}
    \sqrt{-2\ln(u_{2i})}\cos(2\pi u_{2i+1}), & i \text{ is odd}\\
    \sqrt{-2\ln(u_{2i})}\sin(2\pi u_{2i+1}), & i \text{ is even}\\
  \end{cases}\,,
\end{equation*}
and then correlated by
\begin{equation}\label{eqn:gaussian_keystream_generation}
    \vec{g}_k = \mat{A}\vec{z}_k\,,
\end{equation}
where $\mat{A}$ is any matrix such that $\mat{A}\mat{A}^\top = \mat{S}$.

% 
% ########  ########  #### ##     ##    ########  ######## ######## 
% ##     ## ##     ##  ##  ##     ##    ##     ## ##       ##       
% ##     ## ##     ##  ##  ##     ##    ##     ## ##       ##       
% ########  ########   ##  ##     ##    ##     ## ######   ######   
% ##        ##   ##    ##   ##   ##     ##     ## ##       ##       
% ##        ##    ##   ##    ## ##      ##     ## ##       ##       
% ##        ##     ## ####    ###       ########  ######## ##       
% 

\subsection{Cryptographic Estimation Privilege}\label{subsec:crypto_privilege}
The formal definition of a privileged estimation scheme and accompanying notion of covariance privilege are introduced in \cite{risticCryptographicallyPrivilegedState2022} and capture a reduction in estimation performance that can always be achieved from a probabilistic polynomial-time (PPT) estimator knowing only unprivileged measurements, and holding no scheme key, to one knowing both the key and privileged measurements. We will use a slight generalisation of this definition to capture an arbitrary difference that can always be achieved between the estimators (rather than only a reduction).
A privileged estimation scheme is defined by a pair of probabilistic algorithms $(\mathsf{Setup}, \mathsf{Noise})$:
\begin{LaTeXdescription}
  \item[$\mathsf{Setup}(\mathcal{M}_S,\mathcal{M}_M,\kappa)$] Given system and measurement models $\mathcal{M}_S$ and $\mathcal{M}_M$, and the security parameter $\kappa$, public parameters $\mathsf{pub}$ and a secrect key $\mathsf{sk}$ are returned.
  \item[$\mathsf{Noise}(\mathsf{pub},\mathsf{sk},k,\mathcal{M}_S,\mathcal{M}_M,\vec{y}_1,\dots,\vec{y}_k)$] Given public parameters $\mathsf{pub}$, secret key $\mathsf{sk}$, timestep $k$, models $\mathcal{M}_S$ and $\mathcal{M}_M$, and measurements $\vec{y}_1,\dots,\vec{y}_k$, modified privileged and unprivileged measurements, $\vec{y}^{(p)}_k$ and $\vec{y}^{(up)}_k$, respectively, are returned.
\end{LaTeXdescription}
Using the defintions from \cite{risticCryptographicallyPrivilegedState2022} for an \textit{estimator} and \textit{negligible covariance} $\mathsf{neglCov}_m(\kappa)$, the notion of covariance privilege is defined as follows.
\begin{definition}
  A privileged estimation scheme meets notion \textit{$\{\mat{D}_1,\mat{D}_2,\dots\}$-Covariance Privilege for Models $\mathcal{M}_S$ and $\mathcal{M}_M$} if for any PPT estimator $\mathcal{A}$, there exists a PPT estimator $\mathcal{A}^\prime$, such that
  \begin{equation}\label{eqn:cov_priv_security_notion}
    \begin{split}
      &\mathsf{Cov}\left[\mathcal{A}\left(k,\kappa,\mathsf{pub},\mathcal{M}_S,\mathcal{M}_M,\vec{y}^{(up)}_1,\dots,\vec{y}^{(up)}_k\right) - \vec{x}_k\right]\\
      &-\mathsf{Cov}\left[\mathcal{A}^\prime\left(k,\kappa,\mathsf{pub},\mathcal{M}_S,\mathcal{M}_M,\vec{y}^{(p)}_1,\dots,\vec{y}^{(p)}_k\right) - \vec{x}_k\right]\\
      &\quad\succeq \mat{D}_k - \mathsf{neglCov}_m(\kappa)
    \end{split}
  \end{equation}
  for all $k>0$, some negligible covariance and where matrices $\mat{D}_k$ are definite, \textit{i.e.}, $\mat{D}_k \preceq \mat{0}$ or $\mat{D}_k \succeq \mat{0}$. Here, $\mathcal{A}$ and $\mathcal{A}^\prime$ are running in polynomial-time with respect to the parameter $\kappa$ and all probabilities are taken over randomness introduced in models $\mathcal{M}_S$ and $\mathcal{M}_M$, estimators $\mathcal{A}$ and $\mathcal{A}^\prime$, and algorithms $\mathsf{Setup}$ and $\mathsf{Noise}$.
\end{definition}
We note that in the generalised notion \eqref{eqn:cov_priv_security_notion}, $\mat{D}_k\preceq \mat{0}$ is allowed, and unprivileged estimators may now perform better than privileged ones, albeit by a bounded amount. This feature will be useful when discussing additional estimation performance gainable from fusing unprivileged measurements. Lastly, a sign is also corrected, such that negligible covariances are subtracted (rather than added), correctly capturing the additional negligible performance gainable by an unprivileged estimator.

% 
%  .d8888b.   .d8888b.  888    888 8888888888 888b     d888 8888888888 
% d88P  Y88b d88P  Y88b 888    888 888        8888b   d8888 888        
% Y88b.      888    888 888    888 888        88888b.d88888 888        
%  "Y888b.   888        8888888888 8888888    888Y88888P888 8888888    
%     "Y88b. 888        888    888 888        888 Y888P 888 888        
%       "888 888    888 888    888 888        888  Y8P  888 888        
% Y88b  d88P Y88b  d88P 888    888 888        888   "   888 888        
%  "Y8888P"   "Y8888P"  888    888 8888888888 888       888 8888888888 
%                                                                      
%                                                                      
%                                                                      
% 

\section{Privileged Fusion}\label{sec:scheme}
The idea behind our privileged estimation fusion scheme is to add \textit{correlated} Gaussian keystreams to the measurements from each sensor. These noises can be computed and subtracted by estimators holding respective sensor keys, while their correlation limits the additional information gained from fusing unprivileged measurements. 

% 
% ##    ##  #######  ####  ######  ########     ######   ######## ##    ## 
% ###   ## ##     ##  ##  ##    ## ##          ##    ##  ##       ###   ## 
% ####  ## ##     ##  ##  ##       ##          ##        ##       ####  ## 
% ## ## ## ##     ##  ##   ######  ######      ##   #### ######   ## ## ## 
% ##  #### ##     ##  ##        ## ##          ##    ##  ##       ##  #### 
% ##   ### ##     ##  ##  ##    ## ##          ##    ##  ##       ##   ### 
% ##    ##  #######  ####  ######  ########     ######   ######## ##    ## 
% 

\subsection{Noise Generation}\label{subsec:noise_gen}
Similarly to the Gaussian keystream generation in \eqref{eqn:gaussian_keystream_generation}, pseudorandom samples can be correlated in this way even when generated using different stream cipher keys. To parameterise the correlation between noises at each sensor, we introduce a fully correlated component $\mat{Z}\in\mathbb{R}^{m\times m}$ and an uncorrelated component $\mat{Y}\in\mathbb{R}^{m\times m}$ and define a noise cross-correlation matrix for $N$ sensors, $\mat{S} \in \mathbb{R}^{Nm\times Nm}$, as
\begin{equation}\label{eqn:noise_correlation_matrix}
  \mat{S}=
  \begin{bmatrix}
    \mat{Z} & \cdots & \mat{Z}\\
    \vdots & \ddots & \vdots\\
    \mat{Z} & \cdots & \mat{Z}\\
  \end{bmatrix}+\mathsf{diag}\left(
  \begin{bmatrix}
    \mat{Y}\\
    \vdots\\
    \mat{Y}\\
  \end{bmatrix}\right)\,.
\end{equation}
The generation of all $N$ Gaussian noises at timestep $k$, $\vec{g}_k^{(N)}$, can now be written as
\begin{equation}\label{eqn:all_correlated_noises_generation}
  \vec{g}_k^{(N)}=
  \begin{bmatrix}
    \vec{g}_{k,1}\\
    \vdots\\
    \vec{g}_{k,N}
  \end{bmatrix}=
  \mat{S}^\frac{1}{2}\cdot
  \begin{bmatrix}
    \vec{z}_{k,1}\\
    \vdots\\
    \vec{z}_{k,N}
  \end{bmatrix}\,,
\end{equation}
where each $\vec{z}_{k,i}$ is first computed as $\vec{z}_k$ in \eqref{eqn:standard_gaussian_generation}, using uniform samples generated with cipher key $\mathsf{sk}_i$, and $\mat{S}^\frac{1}{2}$ is a matrix such that $\mat{S}^\frac{1}{2}\mat{S}^{\frac{1}{2}\top}=\mat{S}$. Notably, it is important that the first $p$ noises $\vec{g}_{k,1},\dots,\vec{g}_{k,p}$ in \eqref{eqn:all_correlated_noises_generation}, denoted $\vec{g}_k^{(p)}$, can be reproduced by an estimator of privilege $p$, holding only the keys $\mathsf{sk}_i$, $1\leq i \leq p$. When $\mat{S}^\frac{1}{2}$ is a lower-triangular matrix, as is the case when using the Cholesky decomposition of $\mat{S}$, each correlated Gaussian sample $\vec{g}_{k,i}$ is computable from preceeding uniform samples only, $\vec{z}_{k,j}$, $j\leq i$. Then, the generalised noise generation equation
\begin{equation}\label{eqn:p_correlated_noises_generation}
  \vec{g}_k^{(p)}=
  \mat{S}^{\frac{1}{2}(p)}\cdot
  \begin{bmatrix}
    \vec{z}_{k,1}\\
    \vdots\\
    \vec{z}_{k,p}
  \end{bmatrix}\,,
\end{equation}
where $\mat{S}^{\frac{1}{2}(p)}\in\mathbb{R}^{pm\times pm}$ is the top left block from the lower-triangular matrix $\mat{S}^\frac{1}{2}$, can be used to generate the same first $p$ noises $\vec{g}_k^{(p)}$ as would be obtained from \eqref{eqn:all_correlated_noises_generation}.

With \eqref{eqn:p_correlated_noises_generation}, at every timestep $k$, $\vec{g}_k^{(N)}$ can be generated using all $N$ keys and used to modify sensor measurements, while the subset $\vec{g}_k^{(p)}$ can be generated by estimators of privilege $p$ using the only keys they hold.

% 
% ##     ##  #######  ########  ######## ##          ##     ##  #######  ########  
% ###   ### ##     ## ##     ## ##       ##          ###   ### ##     ## ##     ## 
% #### #### ##     ## ##     ## ##       ##          #### #### ##     ## ##     ## 
% ## ### ## ##     ## ##     ## ######   ##          ## ### ## ##     ## ##     ## 
% ##     ## ##     ## ##     ## ##       ##          ##     ## ##     ## ##     ## 
% ##     ## ##     ## ##     ## ##       ##          ##     ## ##     ## ##     ## 
% ##     ##  #######  ########  ######## ########    ##     ##  #######  ########  
% 

\subsection{Measurement Modification}
With a way to generate noises for sensors and estimators, we can introduce the means of measurement modification and the observable measurement models for different estimators. Measurement modification is peformed by adding noises $\vec{g}_k^{(N)}$ to measurements from each sensor $i$ before making them public, resulting in modified measurement equations for each sensor,
\begin{equation}
\begin{split}
  \vec{y}_{k,i}^{(up)} &= \vec{y}_{k,i} + \vec{g}_{k,i}\\
  &= \mat{H}_{k,i}\vec{x}_k + \vec{v}_{k,i} + \vec{g}_{k,i}\,,
\end{split}
\end{equation}
with real measurement noise $\vec{v}_{k,i}\sim\mathcal{N}(\vec{0},\mat{R}_{k,i})$ and the vector of all added noises $\vec{g}_k^{(N)}\ \dot{\sim}\ \mathcal{N}(\vec{0}, \mat{S})$. As we assume that sensors are synchronised, we can capture the correlation between these modified measurements exactly by considering the stacked measurement model for any estmator with access to $q$ measurements, $\mathsf{e}_{p,q}$, at time $k$ given by
\begin{equation}\label{eqn:measurement_equation}
  \vec{y}_k^{(q)} = \mat{H}_k^{(q)}\vec{x}_k + \vec{v}_k^{(q)} + \vec{g}_k^{(q)}
\end{equation}
where $\vec{v}_k^{(q)}\sim\mathcal{N}(\vec{0},\mat{R}_k^{(q)})$ and $\vec{g}_k^{(q)}\ \dot{\sim}\ \mathcal{N}(\vec{0},\mat{S}^{(q)})$, with
\begin{equation*}
  \vec{y}_k^{(q)}=
  \begin{bmatrix}
    \vec{y}_{k,1}\\
    \vdots\\
    \vec{y}_{k,q}
  \end{bmatrix},\ 
  \mat{H}_k^{(q)}=
  \begin{bmatrix}
    \mat{H}_{k,1}\\
    \vdots\\
    \mat{H}_{k,q}\\
  \end{bmatrix}, \
  \vec{v}_k^{(q)}=
  \begin{bmatrix}
    \vec{v}_{k,1}\\
    \vdots\\
    \vec{v}_{k,q}
  \end{bmatrix}\,,
\end{equation*}
\begin{equation*}
  \mat{R}_k^{(q)}=\mathsf{diag}\left(
    \begin{bmatrix}
      \mat{R}_{k,1}\\
      \vdots\\
      \mat{R}_{k,q}
    \end{bmatrix}\right)\,
\end{equation*}
and $\mat{S}^{(q)} \in \mathbb{R}^{qm\times qm}$ is the top left block from the matrix $\mat{S}$, having the same form as \eqref{eqn:noise_correlation_matrix}.

Since we are using a cryptographically sound stream cipher to generate the added Gaussian keystream, the pseudorandom samples are indistingishable from truly random ones to estimators without appropriate keys, which leads us to three observable measurement models for differing estimators.
\begin{LaTeXdescription}
  \item[Estimators of the form $\mathsf{e}_{0,q}$] Here, no keys are held by the unprivileged estimators and generated noise $\vec{g}_k^{(q)}$ is indistinguishable from noise from the truly random distribution $\mathcal{N}(\vec{0}, \mat{S}^{(q)})$. For these estimators, we can rewrite the measurement equation \eqref{eqn:measurement_equation} as the observed measurment equation
  \begin{equation}
    \vec{y}_k^{(0,q)} = \mat{H}_k^{(q)}\vec{x}_k + \vec{v}_k^{\prime(q)}\,,
  \end{equation}
  with new Gaussian noise term $\vec{v}_k^{\prime(q)} \sim \mathcal{N}(\vec{0}, \mat{R}_k^{(q)}+\mat{S}^{(q)})$.
  
  \item[Estimators of the form $\mathsf{e}_{p,p}$] Estimators with keys for all the sensors to which they have access can generate all added noise and subtract it from the recieved measurements. That is, $\vec{g}_k^{(p)}$ can be generated and $\vec{y}_k^{(p,p)}=\vec{y}_k^{(p)}-\vec{g}_k^{(p)}$ computed to give the observed measurement model equal to recieving unmodified measurements only,
  \begin{equation}
    \vec{y}_k^{(p,p)} = \mat{H}_k^{(p)}\vec{x}_k + \vec{v}_k^{(p)}\,,
  \end{equation}
  with $\vec{v}_k^{\prime(p)} \sim \mathcal{N}(\vec{0}, \mat{R}_k^{(p)})$.

  \item[Estimators of the form $\mathsf{e}_{p,q}$, $p<q$] Lastly, we have the observed measurement model when only some accessible measurements can have have their noises removed. Here, care must be taken when deriving the model as noises from sensors $i>p$, which cannot be removed, are conditionally dependant on the known noises $\vec{g}_k^{(p)}$. 
  
  Since we can generate the noises $\vec{g}_k^{(p)}$ and know that $\vec{g}_k^{(q)}\ \dot{\sim}\ \mathcal{N}(\vec{0}, \mat{S}^{(q)})$, we can write 
  \begin{equation}
    \dots
  \end{equation}
  and compute the conditional Gaussian distribution
  \begin{equation}
    \begin{split}
      &\left[\vec{g}_{k,p+1}\ \cdots\ \vec{g}_{k,q}\right]^\top \mid \vec{g}_k^{(p)}\\
      &\qquad \sim \mathcal{N}()
    \end{split}
  \end{equation}

  subtracting the known noises and ofsetting the mean of the unknown noises, these estimators can compute $\dots$ and result in the observed measurement model
  \begin{equation}
    \dots
  \end{equation}
  


  % probably don't use the below part
  If we let the vector capturing known noises be
  \begin{equation}
    \vec{g}_k^{(p,q)}=
    \begin{bmatrix}
      \vec{g}_k^{(p)} & \vec{0} & \cdots & \vec{0}
    \end{bmatrix}^\top\,,
  \end{equation}
  such that $\vec{g}_k^{(p,q)} \in \mathbb{R}^{qm \times m}$, we can compute $\vec{y}_k^{(p,q)}=\vec{y}_k^{(q)}-\vec{g}_k^{(p,q)}$ which, when
\end{LaTeXdescription}

\begin{itemize}
  %\item Now, an estimator of privilege $j$ (that holds the keys $sk_1,...,sk_j$, $j\leq n$), can correctly generate the noises for sensors $1,...,j$ by computing (give partial generation equation up to sensor $j$).
  %\item The subset of computed noises can then be removed from received sensor measurements $z'_1,...,z'_j$ by subtracting it.
  
  %\item Since we are using a cryptographically sound stream cipher, pseudorandom Gaussian samples are indistinguishable from truly random ones to an estimator not holding any relevant keys. We can then consider three estimation problems.
  %\item First, an estimator with access to $j$ sensors and no keys (unprivileged estimator) will have measurements indistinguishable from those following the measurement model given by (model but with additional measurement noise $Y$ and $Z$).
  %\item Second, an estimator with privilege $j$ and access to the first $j$ sensors $1,...,j$ can remove all added pseudorandom noise from observable measurements and follows the measurement model given earlier exactly.
  \item Lastly, an estimator with privilege $j$ and access to the first $j$ sensors $1,...,j$ as well as some additional $l$ remaining sensors. In this case, noises can be removed from the first $j$ measurements, while the remaining $l$ measurements have conditional Gaussian noise based on the first $j$ pseudorandom samples. This can be captured by the measurement equation (give slightly more complicated conditional measurement equation that will not have zero-mean noise).
  \item Intuitively, and from the measurement models observed for the different estimators above, we can tell that the parameters $Z$ and $Y$ will control the difference in estimation performance between estimators.
  \item More specifically, the fully correlated term $Z$ will control the difference in estimation between an unprivileged and privileged estimator, while the uncorrelated term $Y$ will control the difference in estimation between privileged estimators with and without access to additional measurements from sensors to which they do not hold keys.
  \item These two differences correspond to the two guarantees we want to show for the presented scheme (introduced in the problem formulation section).
  \item The effects of choosing these parameters will be formally explored in the cryptography section.
\end{itemize}
\subsection{Noise Distribution}\label{subsec:noise_dist}
\begin{itemize}
  \item While we have described a method for generating noise for $n$ sensors such that different estimators observe different measurement models being followed, we have not discussed where noise is generated and how it is distributed to the relevant sensors.
  \item Due to the correlation between sensor noises in the method above, the generation of one sensor's noise is dependant on generated noise from others. To handle this, they can be generated either centrally and distributed to sensors or sequentially by the sensors $1$ through $n$.
  \item To compute them centrally, equation (generation of $n$ noises given before) is computed by a central processor and each noise $p_{i,k}$, $1\leq i \leq n$, is sent to sensor $i$ to add to their measurement at time $k$.
  \item Sequentially, each sensor can generate its own noise $p_{i,k}$ based on the noises generated before it, that is, given $p_{j,k}$, $1\leq j<i$, the conditional Gaussian can be computed as (equation for generating sequential correlation). However, a downside of this method is the increasing size of data being sent to each sensor as the noise is generated and can result in later sensors requiring more processing power than may be available.
  \item In both of the cases, however, the computation of noises $p_{i,k}$ can be done offline and in advance, such that sensors have sufficient additive noises already computed prior to commencement of measurement.
\end{itemize}

% 
%  .d8888b.  8888888b. Y88b   d88P 8888888b. 88888888888 .d88888b.  
% d88P  Y88b 888   Y88b Y88b d88P  888   Y88b    888    d88P" "Y88b 
% 888    888 888    888  Y88o88P   888    888    888    888     888 
% 888        888   d88P   Y888P    888   d88P    888    888     888 
% 888        8888888P"     888     8888888P"     888    888     888 
% 888    888 888 T88b      888     888           888    888     888 
% Y88b  d88P 888  T88b     888     888           888    Y88b. .d88P 
%  "Y8888P"  888   T88b    888     888           888     "Y88888P"  
%                                                                   
%                                                                   
%                                                                   
% 

\section{Cryptographic Privilege}\label{sec:crypto}
\begin{itemize}
  \item To give a sketch proof of the cryptographic privilege provided by the presented multisensor scheme, we first recall two important assumptions. We consider cryptographically generated random floating-point numbers to be sufficiently close to real numbers that real number proofs can be used, namely the optimality of the Kalman filter, and that all sensors are synchronised, such that noises $p_{i,k}$ are always added to measurements $z_{i,k}$ from each sensor and that the measurement stacked model (given a the start of the scheme section) is correct for all $k$.
  \item The sketch proof will rely on the optimality of the linear Kalman filter to produce a series of covariances that are the best achievable (smallest possible) for given estimators and take the difference between estimators in question to bound their difference and achieve cryptographic estimation privilege.
  \item Similarly to the previous paper, the bounding series can be used in a cryptographic sketch proof which shows that the existence of an estimator violating the bound would imply the existence of a better linear estimator than the Kalman filter, known not to exist. This then guarantees the bound by contrapositive.
  \item We consider two types of unprivileged estimation which we want to bound, namely estimators holding no keys and estimators holding only a subset of keys, as specified in the desired guarantees.
\end{itemize}

\subsection{Unprivileged Adversaries}\label{subsec:crypto_unprivileged}
\begin{itemize}
  \item If we assume an unprivileged estimator can access all $n$ sensors, then their stacked estimation model can be described by the appropriate equation at each timestep $k$. 
  \item We can then write the combined Kalman predict and update equation as the equation with params from the previous one.
  \item Due to the KF preserving error covariance order, by setting $P_0=0$ we get a series of covariance such that no unprivileged estimator can estimate with error covariances less than or equal to the series (lower-bound).
  \item Similarly we can do the same for an estimator to which we want to lower-bound the estimation difference with the unprivileged estimator. 
  \item A privileged estimator of privilege $j$ (access to the first $j$ keys) and that can only access the first $j$ sensors, has the appropriate measurement equation. Similarly, setting the initial covariance to zero gives the lower bound series on the best possible estimation error achievable by the privileged estimator using only the measurements from the sensors to which it holds keys.
  \item Taking the difference of the two estimator bounding series' produces the difference series.
  \item In the context of cryptographic privileged estimation scheme, the Setup and Noise algorithms are given accordingly. The optimality of the KF can then be used to achieve the security notion.
  \item In the above, we assume the unprivileged estimator has access to all $n$ sensors, while the $j$ privilege estimator has access to only the first $j$ sensors. In the case when the unprivileged estimator has access to fewer sensors or the privileged one to more, their difference in estimation can only increase, thus keeping the computed lower-bound a lower-bound and the cryptographic guarantee does not change (albeit the definitions of Setup and Noise will, to capture the now available sets of measurements).
\end{itemize}

\subsection{Privileged Adversaries}\label{subsec:crypto_privileged}
\begin{itemize}
  \item We can use a similar approach to separately guarantee the largest possible benefit in estimation available to an estimator of privilege $j$ (access to first $j$ keys) when fusing measurements from sensors to which they do not hold keys to get a better state estimate.
  \item We can again write stacked estimation models for the two estimators. The estimator of privilege $j$ with access to the first $j$ measurements still follows the model (given in the previous subsection).
  \item The estimator with access to the additional $l$ measurements, however, does not have zero-mean measurement noise as seen in (equation for the additional measurements estimator given before) required for the Kalman filter. As the mean is known at each $k$, from the known noises $p_{i,k}$, $1\leq i\leq j$, remaining measurements can be offset to produce the equivalent measurement model with zero-mean noise (given here).
  \item Again, using the combined predict and update equations of the KF and setting $P_0=0$, we can use the optimality of the KF to give the best possible performances of the estimators as a series of covariances.
  \item Taking the difference of the bounds now gives a bound on how much better an estimate can become when unprivileged measurements are fused with privileged ones.
  \item In the context of a cryptographic privileged estimation scheme, the Setup and Noise algorithms can be given as follows. KF optimality can then be used to achieve the security notion.
  \item We note that unlike in the unprivileged adversary case, or the previous paper, here we do not use unmodified measurements for the privileged estimates and the resulting algorithms provide better estimation for the adversary than the privileged estimator. In this form, we bound how much better an adversary can estimate when using unprivileged estimates resulting in series $D_k$ consisting of negative-definite rather than positive definite matrices. This makes use of the generalised cryptographic definitions earlier.
\end{itemize}

% 
%  .d8888b. 8888888 888b     d888 
% d88P  Y88b  888   8888b   d8888 
% Y88b.       888   88888b.d88888 
%  "Y888b.    888   888Y88888P888 
%     "Y88b.  888   888 Y888P 888 
%       "888  888   888  Y8P  888 
% Y88b  d88P  888   888   "   888 
%  "Y8888P" 8888888 888       888 
%                                 
%                                 
%                                 
% 

\section{Simulation}\label{sec:sim}
\begin{itemize}
  \item In addition to showing how to derive the bounds to the benefits of using unprivileged measurements, we have simulated concrete scenarios to demonstrate the methods.
  \item We consider the following linear system, and linear measurement models for $4$ sensors. Correlated and uncorrelated noise covariances are of the form $Y=\sigma_y I$ and $Z = \sigma_z I$.
  \item Implementation details.
  \item First figure shows $4$ plots. Each plot shows three traces. The traces are the trace of the unprivileged estimator (no keys, all measurements), the trace of a privilege $j$ estimator ($j$ measurements) and the trace of a fusing privilege $j$ estimators (all measurements). $j$ is equal to $1,2,3$ and $4$ for each plot, respectively. Here, the difference between the first two traces in figure $4$ and the second two traces in figure $1$ is equal to the traces of the two $D_k$ series from the cryptography section, respectively. Values for $\sigma_y$, $\sigma_z$ are fixed.
  \item The second figure focuses on a single plot from the first figure but varies $\sigma_y$ and $\sigma_z$. Again, $4$ plots are shown, with $\sigma_y$ increased in two and $\sigma_z$ increased in two, such that they are both increased in only one plot. This will show that while both parameters affect the estimation of unprivileged and additional fusion estimators, $\sigma_y$ and therefore $Y$ predominantly affects the unprivileged estimator and $\sigma_z$, $Z$, affects the additional fusion estimator.
\end{itemize}

% 
%  .d8888b.   .d88888b.  888b    888  .d8888b.  
% d88P  Y88b d88P" "Y88b 8888b   888 d88P  Y88b 
% 888    888 888     888 88888b  888 888    888 
% 888        888     888 888Y88b 888 888        
% 888        888     888 888 Y88b888 888        
% 888    888 888     888 888  Y88888 888    888 
% Y88b  d88P Y88b. .d88P 888   Y8888 Y88b  d88P 
%  "Y8888P"   "Y88888P"  888    Y888  "Y8888P"  
%                                               
%                                               
%                                               
% 

\section{Conclusion}\label{sec:conc}
\begin{itemize}
  \item Concluding remarks.
  \item Future work includes exploring key subsets that do not need to be sequential, decentralised methods for multi-key correlated noise generation, and the effects and cryptographic guarantees of sensors falling out of synchronisation.
\end{itemize}

% conference papers do not normally have an appendix

% trigger a \newpage just before the given reference
% number - used to balance the columns on the last page
% adjust value as needed - may need to be readjusted if
% the document is modified later
%\IEEEtriggeratref{8}
% The "triggered" command can be changed if desired:
%\IEEEtriggercmd{\enlargethispage{-5in}}

% 
% 8888888b.  8888888888 8888888888 .d8888b.  
% 888   Y88b 888        888       d88P  Y88b 
% 888    888 888        888       Y88b.      
% 888   d88P 8888888    8888888    "Y888b.   
% 8888888P"  888        888           "Y88b. 
% 888 T88b   888        888             "888 
% 888  T88b  888        888       Y88b  d88P 
% 888   T88b 8888888888 888        "Y8888P"  
%                                            
%                                            
%                                            
% 

\bibliographystyle{IEEEtran}
\bibliography{bibliography/PrivilegedFusion}

% that's all folks
\end{document}


